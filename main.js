(()=>{"use strict";var e,t,o,r,n={197:(e,t,o)=>{},497:(e,t,o)=>{o.a(e,(async(e,r)=>{try{o.d(t,{$:()=>k}),o(197);var n=o(694),c=o(947),a=o(547),i=o(866),u=e([a]);function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z(e,t){if(e){if("string"==typeof e)return $(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?$(e,t):void 0}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=Array(t);o<t;o++)r[o]=e[o];return r}function I(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var r,n,c,a,i=[],u=!0,l=!1;try{if(c=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;u=!1}else for(;!(u=(r=c.call(o)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,n=e}finally{try{if(!u&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(l)throw n}}return i}}function D(e){if(Array.isArray(e))return e}a=(u.then?(await u)():u)[0];var l=document.querySelector(".places__list");document.querySelectorAll(".popup").forEach((function(e){e.classList.add("popup_is-animated")}));var s=document.querySelector(".profile__image-edit"),d=document.querySelector(".popup_type_avatar"),f=document.querySelector('form[name="update-avatar"]'),p=f.querySelector('input[name="avatar-link"]'),m=document.querySelector(".profile__image");function J(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Сохранить",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Сохранение...";t.textContent=e?r:o}function G(e){e.preventDefault();var t=p.value,o=e.submitter,r=o.textContent;J(!0,o,r),(0,i.OJ)(t).then((function(e){m.style.backgroundImage="url(".concat(e.avatar,")"),(0,c.fs)(d),f.reset()})).catch((function(e){console.error("Ошибка обновлениz аватара: ".concat(e))})).finally((function(){J(!1,o,r)}))}s.addEventListener("click",(function(){(0,c.PB)(d),(0,a.R)(d,k),f.reset()})),f.addEventListener("submit",G);var v=document.querySelector(".profile__edit-button"),y=document.querySelector(".popup_type_edit"),_=document.querySelector(".profile__add-button"),h=(document.querySelector(".popup_type_new-card"),document.querySelector(".popup_type_image")),S=h.querySelector(".popup__image"),b=h.querySelector(".popup__caption"),k={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};(0,a.F)();var q=document.querySelector(k.formSelector),w=q.querySelector(k.inputSelector),E=(q.querySelector(".".concat(w.id,"-error")),q.querySelector(k.submitButtonSelector),document.querySelectorAll(".popup__close"));v.addEventListener("click",(function(){C.value=x.textContent,L.value=A.textContent,(0,c.PB)(y),(0,a.R)(y,k)})),_.addEventListener("click",(function(){(0,c.PB)(j),(0,a.R)(j,k),O.reset()})),E.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.closest(".popup");t&&(0,c.fs)(t)}))}));var g=document.querySelector('form[name="edit-profile"]'),C=(g.querySelector(".popup__input"),document.querySelector('input[name="name"]')),L=document.querySelector('input[name="description"]'),x=document.querySelector(".profile__title"),A=document.querySelector(".profile__description");function H(e){e.preventDefault();var t=C.value,o=L.value;C.value="",L.value="";var r=e.submitter,n=r.textContent;J(!0,r,n),(0,i.b6)(t,o).then((function(e){if(e)return x.textContent=e.name,A.textContent=e.about,console.log("Данные профиля успешно обновлены:",e),(0,c.fs)(y),e})).catch((function(e){console.error("Произошла ошибка при обновлении профиля:",e)})).finally((function(){J(!1,r,n)}))}g.addEventListener("submit",H);var j=document.querySelector(".popup_type_new-card"),O=document.querySelector('form[name="new-place"]'),B=document.querySelector('input[name="place-name"]'),P=document.querySelector('input[name="link"]');function M(e,t){S.src=e,S.alt=t,b.textContent=t,(0,c.PB)(h)}j.querySelector(".popup__button"),O.addEventListener("submit",(function(e){e.preventDefault();var t=B.value,o=P.value,r=e.submitter,a=r.textContent;J(!0,r,a),(0,i._o)(t,o).then((function(e){if(e){var t=(0,n.z)({name:e.name,link:e.link,_id:e._id,owner:e.owner._id},i.GO,n.o,M,e.owner);l.prepend(t),O.reset(),(0,c.fs)(j)}})).catch((function(e){console.error("Произошла ошибка при добавлении карточки:",e)})).finally((function(){J(!1,r,a)}))})),await Promise.all([(0,i.gL)(),(0,i.Eg)()]).then((function(e){var t,o=D(t=e)||I(t,2)||z(t,2)||T(),r=o[0];o[1].forEach((function(e){var t=e.name,o=e.link,c=e._id,a=e.owner,u=e.likes,s=(0,n.z)({name:t,link:o,_id:c,owner:a,likes:u},i.GO,n.o,M,r);l.append(s)}));var c=document.querySelector(".profile__image");r.avatar?c.style.backgroundImage="url(".concat(r.avatar,")"):c.style.backgroundImage="none";var a=document.querySelector(".profile__title"),u=document.querySelector(".profile__description");a.textContent=r.name,u.textContent=r.about})),r()}catch(N){r(N)}}),1)},547:(e,t,o)=>{o.a(e,(async(e,r)=>{try{o.d(t,{F:()=>l,R:()=>u});var n=o(497),c=e([n]);n=(c.then?(await c)():c)[0];var a=function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.$.inputErrorClass),o.classList.remove(n.$.errorClass),o.textContent=""},i=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.$.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.$.inactiveButtonClass))},u=function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);o.forEach((function(t){a(e,t)})),r.disabled=!0,r.classList.add(t.inactiveButtonClass)},l=function(e){Array.from(document.querySelectorAll(n.$.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(n.$.inputSelector)),o=e.querySelector(n.$.submitButtonSelector);i(t,o),t.forEach((function(r){r.addEventListener("input",(function(){(function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?a(e,t):function(e,t,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n.$.inputErrorClass),r.classList.add(n.$.errorClass),r.textContent=o}(e,t,t.validationMessage)})(e,r),i(t,o)}))}))}(e)}))};r()}catch(e){r(e)}}))},694:(e,t,o)=>{o.d(t,{o:()=>a,z:()=>c});var r=o(866),n=document.querySelector("#card-template").content;function c(e,t,o,r,c){var a=e.name,i=e.link,u=e._id,l=e.owner,s=e.likes,d=n.querySelector(".places__item").cloneNode(!0),f=d.querySelector(".card__delete-button"),p=d.querySelector(".card__like-button"),m=d.querySelector(".card__image");m.src=i,d.querySelector(".card__title").textContent=a,m.alt=a;var v=d.querySelector(".card__like-count");if(v.textContent=s.length,v)return c._id===l._id?(f.style.display="block",f.addEventListener("click",(function(){t(d,u)}))):f.style.display="none",s.some((function(e){return e._id===c._id}))&&p.classList.add("card__like-button_is-active"),p.addEventListener("click",(function(e){o(e,u,v)})),m.addEventListener("click",(function(){r(i,a)})),d;console.error("Элемент .card__like-count не найден в шаблоне")}function a(e,t,o){var n=e.target,c=n.classList.contains("card__like-button_is-active");if(console.log("likeCountElement:",o),console.log("likeButton:",n),o&&n){var a=0;o.textContent&&(a=parseInt(o.textContent,10)),c?(0,r.TX)(t).then((function(e){e&&(n.classList.remove("card__like-button_is-active"),a--,o.textContent=a>=0?e.likes.length:"",console.log("Лайк удален успешно"))})).catch((function(e){console.error("Ошибка при удалении лайка:",e)})):(0,r.HL)(t).then((function(e){e&&(n.classList.add("card__like-button_is-active"),a++,o.textContent=e.likes.length,console.log("Лайк установлен успешно"))})).catch((function(e){console.error("Ошибка при установке лайка:",e)}))}else console.error("Элементы не найдены в likedCard")}},866:(e,t,o)=>{o.d(t,{Eg:()=>n,GO:()=>i,HL:()=>u,OJ:()=>s,TX:()=>l,_o:()=>a,b6:()=>c,gL:()=>r});var r=function(){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/users/me",{method:"GET",headers:{Authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66"}}).then((function(e){return e.json()}))},n=function(){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/cards",{headers:{Authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66"}}).then((function(e){return e.json()}))},c=function(e,t){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/users/me",{method:"PATCH",headers:{authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){if(!e.ok)throw new Error("Ошибка обновления профиля");return e.json()}))},a=function(e,t){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/cards",{method:"POST",headers:{authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66","Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){if(!e.ok)throw new Error("Ошибка при добавлении карточки: статус ".concat(e.status));return e.json()})).then((function(e){return console.log("Новая карточка успешно добавлена:",e),e})).catch((function(e){return console.error("Ошибка добавления карточки:",e),null}))};function i(e,t){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/cards/".concat(t),{method:"DELETE",headers:{authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66"}}).then((function(t){if(!t.ok)throw new Error("Ошибка при удалении карточки: статус ".concat(t.status));e.remove()})).catch((function(e){console.error("Ошибка удаления карточки:",e)}))}var u=function(e){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66"}}).then((function(e){if(!e.ok)throw new Error("Ошибка при лайке карточки: статус ".concat(e.status));return e.json()})).catch((function(e){return console.error("Ошибка при установке лайка:",e),null}))},l=function(e){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66"}}).then((function(e){if(!e.ok)throw new Error("Ошибка при лайке карточки: статус ".concat(e.status));return e.json()})).catch((function(e){return console.error("Ошибка при удалении лайка:",e),null}))},s=function(e){return fetch("https://mesto.nomoreparties.co/v1/wff-cohort-40/users/me/avatar",{method:"PATCH",headers:{authorization:"d40019f3-d207-40df-a273-89cf4c1c6a66","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return e.json()}))}},947:(e,t,o)=>{function r(e){e.classList.add("popup_is-opened"),document.body.style.overflow="hidden",document.addEventListener("click",c),document.addEventListener("keydown",a)}function n(e){e.classList.remove("popup_is-opened"),document.body.style.overflow="auto",document.removeEventListener("click",c),document.removeEventListener("keydown",a)}function c(e){var t=e.target.closest(".popup");(e.target.classList.contains("popup__close")||e.target===t)&&n(t)}function a(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");t&&n(t)}}o.d(t,{PB:()=>r,fs:()=>n})}},c={};function a(e){var t=c[e];if(void 0!==t)return t.exports;var o=c[e]={exports:{}};return n[e](o,o.exports,a),o.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",o="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},a.a=(n,c,a)=>{var i;a&&((i=[]).d=-1);var u,l,s,d=new Set,f=n.exports,p=new Promise(((e,t)=>{s=t,l=e}));p[t]=f,p[e]=e=>(i&&e(i),d.forEach(e),p.catch((e=>{}))),n.exports=p,c((n=>{var c;u=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[e])return n;if(n.then){var c=[];c.d=0,n.then((e=>{a[t]=e,r(c)}),(e=>{a[o]=e,r(c)}));var a={};return a[e]=e=>e(c),a}}var i={};return i[e]=e=>{},i[t]=n,i})))(n);var a=()=>u.map((e=>{if(e[o])throw e[o];return e[t]})),l=new Promise((t=>{(c=()=>t(a)).r=0;var o=e=>e!==i&&!d.has(e)&&(d.add(e),e&&!e.d&&(c.r++,e.push(c)));u.map((t=>t[e](o)))}));return c.r?l:a()}),(e=>(e?s(p[o]=e):l(f),r(i)))),i&&i.d<0&&(i.d=0)},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a(497)})();